{% extends "templates/base.jinja" %}
{% include "templates/posts.jinja" %}

{% block head %}
<script>
function follow(username) {
    endpoint = `http://localhost:8080/follow/${username}`;
    console.log(endpoint);
    fetch(endpoint, {
        method: "DELETE"
    });
    location.reload();
}
function unfollow(username) {
    endpoint = `http://localhost:8080/unfollow/${username}`;
    console.log(endpoint);
    fetch(endpoint, {
        method: "DELETE"
    });
    location.reload();
}
function promote(username) {
    endpoint = `http://localhost:8080/promote/${username}`;
    console.log(endpoint);
    fetch(endpoint, {
        method: "DELETE"
    });
    location.reload();
}
function deleteUser(username) {
    endpoint = `http://localhost:8080/deleteUser/${username}`;
    console.log(endpoint);
    fetch(endpoint, {
        method: "DELETE"
    });
    window.location.replace("/")
}
function ban(username) {
    endpoint = `http://localhost:8080/ban/${username}`;
    console.log(endpoint);
    fetch(endpoint, {
        method: "DELETE"
    });
    location.reload();
}
function unban(username) {
    endpoint = `http://localhost:8080/unban/${username}`;
    console.log(endpoint);
    fetch(endpoint, {
        method: "DELETE"
    });
    location.reload();
}
</script>
{% block Posthead %}{% endblock %}
{% endblock %}

{% block content %}

{{username}}
<a href="/followers/{{ username }}">View Followers</a>
<a href="/following/{{ username }}">View Following</a>
{% if followStatus is defined%}
    {% if followStatus is true %}
        <button onclick="unfollow('{{ username }}')"> unfollow </button>
    {% else %}
        <button onclick="follow('{{ username }}')"> follow </button>
    {% endif %}

    {% if permissions and not userIsAdmin and not userIsBanned%}
    <button onclick="promote('{{ username }}')"> promote </button>
    {% endif %}

    {% if permissions and not userIsAdmin %}
    <button onclick="deleteUser('{{ username }}')"> delete user </button>
    {% endif%}

    {% if permissions and not userIsBanned %}
    <button onclick="ban('{{ username }}')"> ban </button>
    {% elif permissions and userIsBanned %}
    <button onclick="unban('{{ username }}')"> unban </button>
    {% endif %}

    <br>
{% endif %}

{% block Postcontent %}{% endblock %}
{% endblock %}